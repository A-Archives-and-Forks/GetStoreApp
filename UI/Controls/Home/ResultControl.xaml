<UserControl
    x:Class="GetStoreApp.UI.Controls.Home.ResultControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ctWinUI="using:CommunityToolkit.WinUI.UI.Controls"
    xmlns:service="using:GetStoreApp.Services.Settings"
    xmlns:viewModel="using:GetStoreApp.ViewModels.Controls.Home"
    x:Name="ResultControlTest"
    mc:Ignorable="d">

    <UserControl.Resources>
        <viewModel:ResultViewModel x:Name="viewModel" />
    </UserControl.Resources>

    <Grid
        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
        CornerRadius="{ThemeResource ColorPickerSliderCornerRadius}"
        Visibility="{x:Bind ViewModel.ResultControlVisable, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Style="{StaticResource DataGridDescriptionGridStyle}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <FontIcon
                Grid.Column="0"
                FontFamily="Segoe Fluent Icons"
                Glyph="&#xE71e;"
                Style="{StaticResource FontIconStyle}" />
            <TextBlock
                Grid.Column="1"
                VerticalAlignment="Center"
                Text="{x:Bind service:LanguageService.GetResources('/Home/SearchResult')}" />
            <AppBarSeparator Grid.Column="2" Margin="10,0,10,0" />
            <StackPanel
                Grid.Column="3"
                VerticalAlignment="Center"
                Visibility="{x:Bind ViewModel.ResultDataList.Count, Converter={StaticResource IntToVisibilityConverter}, Mode=OneWay}">
                <TextBlock Text="{x:Bind ViewModel.CategoryId, Mode=OneWay}" />
                <TextBlock Text="{x:Bind ViewModel.ResultDataList.Count, Converter={StaticResource ResultCountInfoFormatConverter}, Mode=OneWay}" />
            </StackPanel>
            <TextBlock
                Grid.Column="3"
                VerticalAlignment="Center"
                Text="{x:Bind service:LanguageService.GetResources('/Home/SearchResultEmpty')}"
                Visibility="{x:Bind ViewModel.ResultDataList.Count, Converter={StaticResource IntToReverseVisibilityConverter}, Mode=OneWay}" />
            <CommandBar
                Grid.Column="4"
                VerticalAlignment="Center"
                Background="Transparent"
                DefaultLabelPosition="Right">
                <AppBarButton
                    Icon="Copy"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/CopyCategoryID')}"
                    ToolTipService.ToolTip="{x:Bind service:LanguageService.GetResources('/Home/CopyCategoryID')}"
                    Visibility="{x:Bind ViewModel.IsSelectionMode, Converter={StaticResource BooleanToReverseVisibilityConverter}, Mode=OneWay}" />
                <AppBarButton
                    Command="{x:Bind ViewModel.SelectCommand}"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/Select')}"
                    Visibility="{x:Bind ViewModel.IsSelectionMode, Converter={StaticResource BooleanToReverseVisibilityConverter}, Mode=OneWay}">
                    <AppBarButton.Icon>
                        <FontIcon
                            Grid.Column="0"
                            FontFamily="Segoe Fluent Icons"
                            Glyph="&#xE762;" />
                    </AppBarButton.Icon>
                </AppBarButton>
                <AppBarButton
                    Icon="Copy"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/Copy')}"
                    Visibility="{x:Bind ViewModel.IsSelectionMode, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay}" />
                <AppBarButton
                    Icon="Download"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/Download')}"
                    Visibility="{x:Bind ViewModel.IsSelectionMode, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay}" />
                <AppBarButton
                    Command="{x:Bind ViewModel.CancelCommand}"
                    Icon="Cancel"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/Cancel')}"
                    Visibility="{x:Bind ViewModel.IsSelectionMode, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay}" />
            </CommandBar>
        </Grid>

        <ctWinUI:DataGrid
            x:Name="ResultDataGrid"
            Grid.Row="1"
            ItemsSource="{x:Bind ViewModel.ResultDataList, Mode=OneWay}"
            RowStyle="{StaticResource DataGridRowStyle}"
            Style="{StaticResource DataGridResultStyle}"
            Visibility="{x:Bind ViewModel.ResultDataList.Count, Converter={StaticResource IntToVisibilityConverter}, Mode=OneWay}">

            <ctWinUI:DataGrid.Columns>

                <ctWinUI:DataGridTextColumn
                    Width="Auto"
                    Binding="{Binding SerialNumber}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/SerialNumber')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}" />

                <ctWinUI:DataGridTemplateColumn
                    Width="4*"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/FileName')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}">
                    <ctWinUI:DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <HyperlinkButton
                                VerticalAlignment="Center"
                                Content="{Binding FileName}"
                                NavigateUri="{Binding FileLink}"
                                ToolTipService.ToolTip="{Binding FileName}" />
                        </DataTemplate>
                    </ctWinUI:DataGridTemplateColumn.CellTemplate>
                </ctWinUI:DataGridTemplateColumn>

                <ctWinUI:DataGridTextColumn
                    Width="Auto"
                    Binding="{Binding FileLinkExpireTime, Converter={StaticResource GMTFormatConverter}}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/LinkExpireTime')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}" />

                <ctWinUI:DataGridTextColumn
                    Width="3*"
                    Binding="{Binding FileSHA1}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/FileSHA1')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}" />

                <ctWinUI:DataGridTextColumn
                    Width="Auto"
                    Binding="{Binding FileSize}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/FileSize')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}" />
            </ctWinUI:DataGrid.Columns>
        </ctWinUI:DataGrid>
    </Grid>
</UserControl>
