<UserControl
    x:Class="GetStoreApp.UI.Controls.Home.ResultControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ctWinUI="using:CommunityToolkit.WinUI.UI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:service="using:GetStoreApp.Services.Settings"
    x:Name="ResultControlTest"
    mc:Ignorable="d">

    <Grid
        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
        CornerRadius="{ThemeResource ColorPickerSliderCornerRadius}"
        Visibility="{x:Bind ViewModel.ResultControlVisable, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid
            Grid.Row="0"
            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
            Style="{StaticResource DataGridDescriptionGridStyle}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <FontIcon
                Grid.Column="0"
                FontFamily="Segoe Fluent Icons"
                Glyph="&#xE71e;"
                Style="{StaticResource FontIconStyle}" />

            <TextBlock
                Grid.Column="1"
                VerticalAlignment="Center"
                Text="{x:Bind service:LanguageService.GetResources('/Home/SearchResult')}" />

            <AppBarSeparator Grid.Column="2" Margin="10,0,10,0" />

            <StackPanel
                Grid.Column="3"
                VerticalAlignment="Center"
                Visibility="{x:Bind ViewModel.ResultDataList.Count, Converter={StaticResource IntToVisibilityConverter}, Mode=OneWay}">
                <TextBlock Text="{x:Bind ViewModel.CategoryId, Converter={StaticResource CategoryIDInfoFormatConverter}, Mode=OneWay}" />
                <TextBlock Text="{x:Bind ViewModel.ResultDataList.Count, Converter={StaticResource ResultCountInfoFormatConverter}, Mode=OneWay}" />
            </StackPanel>

            <TextBlock
                Grid.Column="3"
                VerticalAlignment="Center"
                Text="{x:Bind service:LanguageService.GetResources('/Home/SearchResultEmpty')}"
                Visibility="{x:Bind ViewModel.ResultDataList.Count, Converter={StaticResource IntToReverseVisibilityConverter}, Mode=OneWay}" />

            <CommandBar
                Grid.Column="4"
                VerticalAlignment="Center"
                Background="Transparent"
                DefaultLabelPosition="Right"
                Visibility="{x:Bind ViewModel.IsSelectMode, Converter={StaticResource BooleanToReverseVisibilityConverter}, Mode=OneWay}">

                <AppBarButton Icon="Copy" Label="{x:Bind service:LanguageService.GetResources('/Home/Copy')}">
                    <AppBarButton.Flyout>
                        <MenuFlyout Placement="Bottom">
                            <MenuFlyoutItem Command="{x:Bind ViewModel.CopyCategoryIDCommand}" Text="{x:Bind service:LanguageService.GetResources('/Home/CopyCategoryID')}" />
                            <MenuFlyoutItem Command="{x:Bind ViewModel.CopySingleCommand}" Text="{x:Bind service:LanguageService.GetResources('/Home/CopySingle')}" />
                        </MenuFlyout>
                    </AppBarButton.Flyout>
                </AppBarButton>

                <AppBarButton
                    Icon="Download"
                    IsEnabled="False"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/Download')}" />

                <AppBarButton Command="{x:Bind ViewModel.SelectCommand}" Label="{x:Bind service:LanguageService.GetResources('/Home/Select')}">
                    <AppBarButton.Icon>
                        <FontIcon
                            Grid.Column="0"
                            FontFamily="Segoe Fluent Icons"
                            Glyph="&#xE762;" />
                    </AppBarButton.Icon>
                </AppBarButton>
            </CommandBar>

            <CommandBar
                Grid.Column="4"
                VerticalAlignment="Center"
                Background="Transparent"
                DefaultLabelPosition="Right"
                Visibility="{x:Bind ViewModel.IsSelectMode, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay}">

                <AppBarButton
                    Command="{x:Bind ViewModel.SelectAllCommand}"
                    Icon="SelectAll"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/SelectAll')}" />

                <AppBarButton
                    Command="{x:Bind ViewModel.SelectNoneCommand}"
                    Icon="ClearSelection"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/SelectNone')}" />

                <AppBarButton
                    Command="{x:Bind ViewModel.CopySelectedCommand}"
                    Icon="Copy"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/CopySelected')}" />

                <AppBarButton
                    Icon="Download"
                    IsEnabled="False"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/DownloadSelected')}" />

                <AppBarButton
                    Command="{x:Bind ViewModel.CancelCommand}"
                    Icon="Cancel"
                    Label="{x:Bind service:LanguageService.GetResources('/Home/Cancel')}" />
            </CommandBar>
        </Grid>

        <ctWinUI:DataGrid
            x:Name="ResultDataGrid"
            Grid.Row="1"
            ItemsSource="{x:Bind ViewModel.ResultDataList, Mode=OneWay}"
            RowStyle="{StaticResource DataGridRowStyle}"
            SelectedItem="{x:Bind ViewModel.SelectedResultItem, Mode=TwoWay}"
            Style="{StaticResource DataGridResultStyle}"
            Visibility="{x:Bind ViewModel.ResultDataList.Count, Converter={StaticResource IntToVisibilityConverter}, Mode=OneWay}">

            <ctWinUI:DataGrid.Columns>

                <ctWinUI:DataGridTemplateColumn
                    Width="100"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/Select')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                    IsReadOnly="False"
                    Visibility="{x:Bind ViewModel.IsSelectMode, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay}">

                    <ctWinUI:DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <CheckBox
                                Margin="12,0,0,0"
                                HorizontalAlignment="Left"
                                VerticalAlignment="Center"
                                IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                IsThreeState="False" />
                        </DataTemplate>
                    </ctWinUI:DataGridTemplateColumn.CellTemplate>
                </ctWinUI:DataGridTemplateColumn>

                <ctWinUI:DataGridTemplateColumn
                    Width="4*"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/FileName')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                    IsReadOnly="True">
                    <ctWinUI:DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <HyperlinkButton
                                Margin="12,0,0,0"
                                VerticalAlignment="Center"
                                Content="{Binding FileName}"
                                NavigateUri="{Binding FileLink}"
                                Style="{StaticResource HyperlinkButtonStyle}"
                                ToolTipService.ToolTip="{Binding FileName}" />
                        </DataTemplate>
                    </ctWinUI:DataGridTemplateColumn.CellTemplate>
                </ctWinUI:DataGridTemplateColumn>

                <ctWinUI:DataGridTextColumn
                    Width="Auto"
                    Binding="{Binding FileLinkExpireTime, Converter={StaticResource GMTFormatConverter}}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/LinkExpireTime')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                    IsReadOnly="True" />

                <ctWinUI:DataGridTextColumn
                    Width="3*"
                    Binding="{Binding FileSHA1}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/FileSHA1')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                    IsReadOnly="True" />

                <ctWinUI:DataGridTextColumn
                    Width="Auto"
                    Binding="{Binding FileSize}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/FileSize')}"
                    HeaderStyle="{StaticResource DataGridColumnHeaderStyle}"
                    IsReadOnly="True" />
            </ctWinUI:DataGrid.Columns>
        </ctWinUI:DataGrid>
    </Grid>
</UserControl>
