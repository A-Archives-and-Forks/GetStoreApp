<UserControl
    x:Class="GetStoreApp.UI.Controls.Home.ResultControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ctWinUI="using:CommunityToolkit.WinUI.UI.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:service="using:GetStoreApp.Services.Settings"
    mc:Ignorable="d">

    <UserControl.Resources>
        <ResourceDictionary>

            <Style
                x:Key="SimpleHisTextStyle"
                BasedOn="{StaticResource BodyTextBlockStyle}"
                TargetType="TextBlock">
                <Setter Property="HorizontalAlignment" Value="Center" />
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="TextAlignment" Value="Center" />
            </Style>

            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Styles/Converter.xaml" />
                <ResourceDictionary Source="/Styles/SettingsFontIcon.xaml" />
                <ResourceDictionary Source="/Styles/DataGrid.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>

    <StackPanel Visibility="{x:Bind ViewModel.ResultControlVisable, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay}">
        <Grid Style="{StaticResource DataGridDescriptionGridStyle}">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <FontIcon
                Grid.Column="0"
                FontFamily="Segoe Fluent Icons"
                Glyph="&#xE71e;"
                Style="{StaticResource SettingsFontIconStyle}" />
            <TextBlock
                Grid.Column="1"
                VerticalAlignment="Center"
                Text="{x:Bind service:LanguageService.GetResources('/Home/SearchResult')}" />
            <AppBarSeparator Grid.Column="2" Margin="10,0,10,0" />
            <StackPanel
                Grid.Column="3"
                VerticalAlignment="Center"
                Visibility="{x:Bind ViewModel.ResultCount, Converter={StaticResource IntToVisibilityConverter}, Mode=OneWay}">
                <TextBlock Text="{x:Bind ViewModel.CategoryId, Mode=OneWay}" />
                <TextBlock Text="{x:Bind ViewModel.ResultCountInfo, Mode=OneWay}" />
            </StackPanel>
            <TextBlock
                Grid.Column="3"
                VerticalAlignment="Center"
                Text="{x:Bind service:LanguageService.GetResources('/Home/SearchResultEmpty')}"
                Visibility="{x:Bind ViewModel.ResultCount, Converter={StaticResource IntToReverseVisibilityConverter}, Mode=OneWay}" />
            <CommandBar
                Grid.Column="4"
                VerticalAlignment="Center"
                Background="Transparent"
                DefaultLabelPosition="Right">
                <AppBarButton Icon="Copy" Label="{x:Bind service:LanguageService.GetResources('/Home/Copy')}">
                    <AppBarButton.Flyout>
                        <MenuFlyout Placement="Bottom">
                            <MenuFlyoutItem Text="{x:Bind service:LanguageService.GetResources('/Home/CopyAsOrder')}" />
                            <MenuFlyoutItem Text="{x:Bind service:LanguageService.GetResources('/Home/CopyAll')}" />
                        </MenuFlyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
                <AppBarButton Icon="Download" Label="{x:Bind service:LanguageService.GetResources('/Home/Download')}">
                    <AppBarButton.Flyout>
                        <MenuFlyout Placement="Bottom">
                            <MenuFlyoutItem Text="{x:Bind service:LanguageService.GetResources('/Home/DownloadAsOrder')}" />
                            <MenuFlyoutItem Text="{x:Bind service:LanguageService.GetResources('/Home/DownloadAll')}" />
                        </MenuFlyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
            </CommandBar>
        </Grid>

        <ctWinUI:DataGrid
            ItemsSource="{x:Bind ViewModel.ResultDataList, Mode=OneWay}"
            RowStyle="{StaticResource DataGridRowStyle}"
            Style="{StaticResource DataGridStyle}"
            Visibility="{x:Bind ViewModel.ResultCount, Converter={StaticResource IntToVisibilityConverter}, Mode=OneWay}">

            <ctWinUI:DataGrid.Columns>

                <ctWinUI:DataGridTextColumn
                    Width="Auto"
                    Binding="{Binding SerialNumber}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/SerialNumber')}" />

                <ctWinUI:DataGridTemplateColumn Width="4*" Header="{x:Bind service:LanguageService.GetResources('/Home/FileName')}">
                    <ctWinUI:DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <HyperlinkButton
                                Grid.Column="1"
                                VerticalAlignment="Center"
                                Content="{Binding FileName}"
                                NavigateUri="{Binding FileLink}"
                                ToolTipService.ToolTip="{Binding FileName}" />
                        </DataTemplate>
                    </ctWinUI:DataGridTemplateColumn.CellTemplate>
                </ctWinUI:DataGridTemplateColumn>

                <ctWinUI:DataGridTextColumn
                    Width="Auto"
                    Binding="{Binding FileLinkExpireTime, Converter={StaticResource DataTimeFormatConverter}}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/LinkExpireTime')}" />

                <ctWinUI:DataGridTextColumn
                    Width="3*"
                    Binding="{Binding FileSHA1}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/FileSHA1')}" />

                <ctWinUI:DataGridTextColumn
                    Width="Auto"
                    Binding="{Binding FileSize}"
                    Header="{x:Bind service:LanguageService.GetResources('/Home/FileSize')}" />
            </ctWinUI:DataGrid.Columns>
        </ctWinUI:DataGrid>
        <TextBlock
            Margin="0,10,0,10"
            HorizontalAlignment="Center"
            Text="{x:Bind service:LanguageService.GetResources('/Home/ResultBottom'),}"
            Visibility="{x:Bind ViewModel.ResultCount, Converter={StaticResource IntToVisibilityConverter}, Mode=OneWay}" />
    </StackPanel>
</UserControl>
