<Page
    x:Class="GetStoreAppInstaller.Pages.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converter="using:GetStoreAppInstaller.Helpers.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:language="using:Windows.Globalization"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:model="using:GetStoreAppInstaller.Models"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    xmlns:root="using:GetStoreAppInstaller.Services.Root"
    xmlns:sys="using:System"
    x:Name="MainPageRoot"
    ActualThemeChanged="{x:Bind OnActualThemeChanged}"
    AllowDrop="{x:Bind CanDragFile, Mode=OneWay}"
    Loaded="{x:Bind OnLoaded}"
    mc:Ignorable="d">

    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.ThemeDictionaries>
                <ResourceDictionary x:Key="Default">
                    <Color x:Key="DefaultBackgroundColor">#141414</Color>
                    <SolidColorBrush x:Key="DefaultBackgroundColorBrush" Color="{ThemeResource DefaultBackgroundColor}" />
                </ResourceDictionary>
                <ResourceDictionary x:Key="HighConstract">
                    <Color x:Key="DefaultBackgroundColor">#FF0000</Color>
                    <SolidColorBrush x:Key="DefaultBackgroundColorBrush" Color="{ThemeResource DefaultBackgroundColor}" />
                </ResourceDictionary>
                <ResourceDictionary x:Key="Light">
                    <Color x:Key="DefaultBackgroundColor">#F0F3F9</Color>
                    <SolidColorBrush x:Key="DefaultBackgroundColorBrush" Color="{ThemeResource DefaultBackgroundColor}" />
                </ResourceDictionary>
            </ResourceDictionary.ThemeDictionaries>

            <SolidColorBrush x:Key="ExpanderChevronBackground" Color="Transparent" />
            <SolidColorBrush x:Key="ExpanderChevronPointerOverBackground" Color="Transparent" />
            <SolidColorBrush x:Key="ExpanderChevronPressedBackground" Color="Transparent" />

            <!--  标题栏右键菜单  -->
            <MenuFlyout
                x:Name="TitlebarMenuFlyout"
                x:FieldModifier="public"
                Placement="BottomEdgeAlignedLeft">

                <MenuFlyoutItem
                    Click="{x:Bind OnRestoreClicked}"
                    IsEnabled="{x:Bind IsWindowMaximized, Mode=OneWay}"
                    Style="{StaticResource AppTitleBarMenuFlyoutItemStyle}"
                    Text="{x:Bind root:ResourceService.GetLocalized('Window/Restore')}">

                    <MenuFlyoutItem.Icon>
                        <FontIcon Glyph="&#xE923;" />
                    </MenuFlyoutItem.Icon>
                </MenuFlyoutItem>

                <MenuFlyoutItem
                    Click="{x:Bind OnMoveClicked}"
                    IsEnabled="{x:Bind IsWindowMaximized.Equals(x:False), Mode=OneWay}"
                    Style="{StaticResource AppTitleBarMenuFlyoutItemStyle}"
                    Tag="{x:Bind TitlebarMenuFlyout}"
                    Text="{x:Bind root:ResourceService.GetLocalized('Window/Move')}" />

                <MenuFlyoutItem
                    Click="{x:Bind OnSizeClicked}"
                    IsEnabled="{x:Bind IsWindowMaximized.Equals(x:False), Mode=OneWay}"
                    Style="{StaticResource AppTitleBarMenuFlyoutItemStyle}"
                    Tag="{x:Bind TitlebarMenuFlyout}"
                    Text="{x:Bind root:ResourceService.GetLocalized('Window/Size')}" />

                <MenuFlyoutItem
                    Click="{x:Bind OnMinimizeClicked}"
                    Style="{StaticResource AppTitleBarMenuFlyoutItemStyle}"
                    Text="{x:Bind root:ResourceService.GetLocalized('Window/Minimize')}">
                    <MenuFlyoutItem.Icon>
                        <FontIcon Glyph="&#xE921;" />
                    </MenuFlyoutItem.Icon>
                </MenuFlyoutItem>

                <MenuFlyoutItem
                    Click="{x:Bind OnMaximizeClicked}"
                    IsEnabled="{x:Bind IsWindowMaximized.Equals(x:False), Mode=OneWay}"
                    Style="{StaticResource AppTitleBarMenuFlyoutItemStyle}"
                    Text="{x:Bind root:ResourceService.GetLocalized('Window/Maximize')}">

                    <MenuFlyoutItem.Icon>
                        <FontIcon Glyph="&#xE922;" />
                    </MenuFlyoutItem.Icon>
                </MenuFlyoutItem>

                <MenuFlyoutSeparator Width="200" />

                <MenuFlyoutItem
                    Click="{x:Bind OnCloseClicked}"
                    Style="{StaticResource AppTitleBarMenuFlyoutItemStyle}"
                    Text="{x:Bind root:ResourceService.GetLocalized('Window/Close')}">

                    <MenuFlyoutItem.Icon>
                        <FontIcon Glyph="&#xE8BB;" />
                    </MenuFlyoutItem.Icon>

                    <MenuFlyoutItem.KeyboardAccelerators>
                        <KeyboardAccelerator Key="F4" Modifiers="Menu" />
                    </MenuFlyoutItem.KeyboardAccelerators>
                </MenuFlyoutItem>
            </MenuFlyout>

            <XamlUICommand x:Name="DeleteDependencyPackageCommand" ExecuteRequested="{x:Bind OnDeleteDependencyPackageExecuteRequested}" />
        </ResourceDictionary>
    </Page.Resources>

    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <Grid
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            RowSpacing="10"
            Visibility="{x:Bind IsParseEmpty, Mode=OneWay}">

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto " />
                <RowDefinition Height="Auto " />
            </Grid.RowDefinitions>

            <TextBlock
                Grid.Row="0"
                HorizontalAlignment="Center"
                FontSize="26"
                Text="{x:Bind root:ResourceService.GetLocalized('Installer/ParseEmpty')}" />

            <Button
                Grid.Row="1"
                HorizontalAlignment="Center"
                Click="{x:Bind OnOpenPackageClicked}"
                Content="{x:Bind root:ResourceService.GetLocalized('Installer/OpenPackage')}" />
        </Grid>

        <Grid Visibility="{x:Bind converter:ValueConverterHelper.BooleanToVisibilityReverseConvert(IsParseEmpty), Mode=OneWay}">

            <Grid
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                RowSpacing="10"
                Visibility="{x:Bind converter:ValueConverterHelper.BooleanToVisibilityReverseConvert(IsLoadCompleted), Mode=OneWay}">

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto " />
                    <RowDefinition Height="Auto " />
                </Grid.RowDefinitions>

                <muxc:ProgressRing
                    Grid.Row="0"
                    Width="60"
                    Height="60" />

                <TextBlock
                    Grid.Row="1"
                    FontSize="26"
                    Text="{x:Bind root:ResourceService.GetLocalized('Installer/ParsingApp')}" />
            </Grid>

            <Grid Visibility="{x:Bind IsLoadCompleted, Mode=OneWay}">

                <Grid
                    Margin="30,45,0,0"
                    RowSpacing="3"
                    Visibility="{x:Bind IsParseSuccessfully, Mode=OneWay}">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>

                    <Grid Grid.Row="0" Margin="0,0,30,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>

                        <Grid
                            Grid.Column="0"
                            Width="100"
                            Height="100"
                            Margin="0,0,12,0"
                            Background="#3076C6"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="{StaticResource ControlCornerRadius}">
                            <Image Source="{x:Bind PackageIconImage, Mode=OneWay}" />
                        </Grid>

                        <Grid Grid.Column="1">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="*" />
                            </Grid.RowDefinitions>

                            <TextBlock
                                Grid.Row="0"
                                FontSize="26"
                                FontWeight="SemiBold"
                                Text="{x:Bind PackageName, Mode=OneWay}" />

                            <TextBlock Grid.Row="1">
                                <Run Text="{x:Bind root:ResourceService.GetLocalized('Installer/Publisher')}" />
                                <Run Text="{x:Bind PublisherDisplayName, Mode=OneWay}" />
                            </TextBlock>

                            <TextBlock Grid.Row="2">
                                <Run Text="{x:Bind root:ResourceService.GetLocalized('Installer/PackageVersion')}" />
                                <Run Text="{x:Bind Version.ToString(), Mode=OneWay}" />
                            </TextBlock>

                            <muxc:ProgressBar
                                Grid.Row="3"
                                Padding="0,0,4,0"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center"
                                IsIndeterminate="{x:Bind IsInstallWaiting, Mode=OneWay}"
                                Visibility="{x:Bind IsInstalling, Mode=OneWay}"
                                Value="{x:Bind InstallProgressValue, Mode=OneWay}" />
                        </Grid>

                        <Grid
                            Grid.Column="2"
                            Margin="10,0,0,0"
                            VerticalAlignment="Stretch"
                            RowSpacing="2">

                            <Grid.RowDefinitions>
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <ContentControl
                                Grid.Row="0"
                                Margin="5,0,0,0"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Top"
                                Visibility="{x:Bind converter:ValueConverterHelper.BooleanToVisibilityReverseConvert(IsInstalling), Mode=OneWay}">

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <Button
                                        Grid.Column="0"
                                        Width="34"
                                        Height="34"
                                        Margin="0,0,3,0"
                                        Padding="0"
                                        Click="{x:Bind OnOpenPackageClicked}"
                                        ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/OpenPackage')}">

                                        <FontIcon FontSize="16" Glyph="&#xE8E5;" />
                                    </Button>

                                    <Button
                                        Grid.Column="1"
                                        Width="34"
                                        Height="34"
                                        Margin="0,0,3,0"
                                        Padding="0"
                                        ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/AddDependency')}">

                                        <Button.Content>
                                            <FontIcon FontSize="16" Glyph="&#xE710;" />
                                        </Button.Content>

                                        <Button.Flyout>
                                            <Flyout
                                                x:Name="AddDependencyFlyout"
                                                Placement="Bottom"
                                                ShouldConstrainToRootBounds="False">

                                                <Flyout.FlyoutPresenterStyle>
                                                    <Style BasedOn="{StaticResource DefaultFlyoutPresenterStyle}" TargetType="FlyoutPresenter">
                                                        <Setter Property="Padding" Value="0" />
                                                        <Setter Property="MinWidth" Value="0" />
                                                    </Style>
                                                </Flyout.FlyoutPresenterStyle>

                                                <Grid DataContext="{x:Bind MainPageRoot}">
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="40" />
                                                        <RowDefinition Height="*" />
                                                    </Grid.RowDefinitions>

                                                    <Grid
                                                        Grid.Row="0"
                                                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                        BorderThickness="0,0,0,1">

                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="Auto" />
                                                        </Grid.ColumnDefinitions>

                                                        <FontIcon
                                                            Grid.Column="0"
                                                            Margin="16,0,6,0"
                                                            VerticalAlignment="Center"
                                                            FontSize="16"
                                                            Glyph="&#xE8BC;" />

                                                        <TextBlock
                                                            Grid.Column="1"
                                                            VerticalAlignment="Center"
                                                            FontSize="14"
                                                            Text="{x:Bind root:ResourceService.GetLocalized('Installer/AddedDependencyPackage')}" />

                                                        <Button
                                                            Grid.Column="2"
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Click="{x:Bind OnAddDependencyClicked}"
                                                            Style="{StaticResource AlternateCloseButtonStyle}"
                                                            ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/AddDependency')}">

                                                            <Button.Content>
                                                                <FontIcon
                                                                    Margin="4"
                                                                    FontSize="16"
                                                                    Glyph="&#xE710;" />
                                                            </Button.Content>
                                                        </Button>

                                                        <Button
                                                            Grid.Column="3"
                                                            Margin="-5,0,0,0"
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Click="{x:Bind OnClearDependencyClicked}"
                                                            IsEnabled="{x:Bind sys:Convert.ToBoolean(InstallDependencyCollection.Count), Mode=OneWay}"
                                                            Style="{StaticResource AlternateCloseButtonStyle}"
                                                            ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/ClearDependency')}">

                                                            <Button.Content>
                                                                <FontIcon
                                                                    Margin="4"
                                                                    FontSize="16"
                                                                    Glyph="&#xE74D;" />
                                                            </Button.Content>
                                                        </Button>

                                                        <Button
                                                            Grid.Column="4"
                                                            Margin="-5,0,0,0"
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Click="{x:Bind OnCloseFlyoutClicked}"
                                                            Style="{StaticResource AlternateCloseButtonStyle}"
                                                            Tag="AddDependencyFlyout"
                                                            ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/CloseFlyout')}">

                                                            <Button.Content>
                                                                <FontIcon
                                                                    Margin="4"
                                                                    FontSize="16"
                                                                    Glyph="&#xE711;" />
                                                            </Button.Content>
                                                        </Button>
                                                    </Grid>

                                                    <Grid
                                                        Grid.Row="1"
                                                        Width="300"
                                                        Height="100"
                                                        Padding="20"
                                                        Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityReverseConvert(InstallDependencyCollection.Count), Mode=OneWay}">
                                                        <TextBlock
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind root:ResourceService.GetLocalized('Installer/AddDependencyListEmpty')}"
                                                            TextAlignment="Center"
                                                            TextWrapping="WrapWholeWords" />
                                                    </Grid>

                                                    <ListView
                                                        Grid.Row="1"
                                                        Width="450"
                                                        Height="200"
                                                        ItemsSource="{x:Bind InstallDependencyCollection, Mode=OneWay}"
                                                        ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                                        ScrollViewer.HorizontalScrollMode="Disabled"
                                                        ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                        ScrollViewer.VerticalScrollMode="Enabled"
                                                        SelectionMode="None"
                                                        Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityConvert(InstallDependencyCollection.Count), Mode=OneWay}">

                                                        <ListView.ItemContainerStyle>
                                                            <Style BasedOn="{StaticResource DefaultListViewItemStyle}" TargetType="ListViewItem">
                                                                <Setter Property="Background" Value="Transparent" />
                                                                <Setter Property="Margin" Value="0" />
                                                                <Setter Property="MinHeight" Value="0" />
                                                                <Setter Property="Padding" Value="0" />
                                                            </Style>
                                                        </ListView.ItemContainerStyle>

                                                        <ListView.ItemTemplate>
                                                            <DataTemplate x:DataType="model:InstallDependencyModel">
                                                                <Grid
                                                                    Height="60"
                                                                    Margin="2,0"
                                                                    Padding="16,0,6,0"
                                                                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                                                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                                    BorderThickness="1"
                                                                    CornerRadius="{StaticResource ControlCornerRadius}">

                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="*" />
                                                                        <ColumnDefinition Width="Auto" />
                                                                    </Grid.ColumnDefinitions>

                                                                    <Grid
                                                                        Grid.Column="0"
                                                                        VerticalAlignment="Center"
                                                                        RowSpacing="2">
                                                                        <Grid.RowDefinitions>
                                                                            <RowDefinition Height="Auto" />
                                                                            <RowDefinition Height="Auto" />
                                                                        </Grid.RowDefinitions>

                                                                        <TextBlock
                                                                            x:Name="DependencyNameText"
                                                                            Grid.Row="0"
                                                                            MinWidth="50"
                                                                            Margin="0,0,5,0"
                                                                            VerticalAlignment="Center"
                                                                            FontSize="14"
                                                                            Text="{x:Bind DependencyName}"
                                                                            TextAlignment="Left"
                                                                            TextTrimming="CharacterEllipsis">

                                                                            <ToolTipService.ToolTip>
                                                                                <ToolTip
                                                                                    MaxWidth="9999"
                                                                                    Content="{x:Bind DependencyName}"
                                                                                    Visibility="{Binding ElementName=DependencyNameText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                                            </ToolTipService.ToolTip>
                                                                        </TextBlock>

                                                                        <TextBlock
                                                                            x:Name="DependencyInfoText"
                                                                            Grid.Row="1"
                                                                            MinWidth="50"
                                                                            Margin="0,0,5,0"
                                                                            VerticalAlignment="Center"
                                                                            FontSize="14"
                                                                            TextAlignment="Left"
                                                                            TextTrimming="CharacterEllipsis">

                                                                            <Run Text="{x:Bind DependencyVersion}" />
                                                                            <Run Text=" | " />
                                                                            <Run Text="{x:Bind DependencyPublisher}" />

                                                                            <ToolTipService.ToolTip>
                                                                                <ToolTip MaxWidth="9999" Visibility="{Binding ElementName=DependencyInfoText, Path=IsTextTrimmed, Mode=OneWay}">
                                                                                    <TextBlock>
                                                                                        <Run Text="{x:Bind DependencyVersion}" />
                                                                                        <Run Text=" | " />
                                                                                        <Run Text="{x:Bind DependencyPublisher}" />
                                                                                    </TextBlock>
                                                                                </ToolTip>
                                                                            </ToolTipService.ToolTip>
                                                                        </TextBlock>
                                                                    </Grid>

                                                                    <Button
                                                                        Grid.Column="1"
                                                                        Width="Auto"
                                                                        Height="Auto"
                                                                        Margin="10,0,0,0"
                                                                        HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"
                                                                        Command="{StaticResource DeleteDependencyPackageCommand}"
                                                                        CommandParameter="{x:Bind DependencyFullName}"
                                                                        Style="{StaticResource AlternateCloseButtonStyle}"
                                                                        ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/DeleteDependencyPackage')}">

                                                                        <Button.Content>
                                                                            <FontIcon
                                                                                Margin="4"
                                                                                FontSize="16"
                                                                                Glyph="&#xE711;" />
                                                                        </Button.Content>
                                                                    </Button>
                                                                </Grid>
                                                            </DataTemplate>
                                                        </ListView.ItemTemplate>
                                                    </ListView>
                                                </Grid>
                                            </Flyout>
                                        </Button.Flyout>
                                    </Button>

                                    <Button
                                        Grid.Column="2"
                                        Width="32"
                                        Height="32"
                                        Padding="0"
                                        Click="{x:Bind OnInstallAppClicked}"
                                        Style="{StaticResource AccentButtonStyle}"
                                        ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/InstallApp')}">

                                        <FontIcon FontSize="16" Glyph="&#xE74B;" />
                                    </Button>
                                </Grid>
                            </ContentControl>

                            <Button
                                Grid.Row="0"
                                Width="32"
                                Height="32"
                                Padding="0"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Top"
                                Click="{x:Bind OnCancelInstallClicked}"
                                IsEnabled="{x:Bind IsCancelInstall, Mode=OneWay}"
                                Style="{StaticResource AccentButtonStyle}"
                                ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/CancelInstall')}"
                                Visibility="{x:Bind IsInstalling, Mode=OneWay}">

                                <FontIcon FontSize="16" Glyph="&#xE711;" />
                            </Button>

                            <Grid
                                Grid.Row="1"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center"
                                ColumnSpacing="5">

                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    Grid.Column="0"
                                    Margin="0,0,0,4"
                                    VerticalAlignment="Center"
                                    FontSize="16"
                                    Text="{x:Bind InstallStateString, Mode=OneWay}"
                                    TextAlignment="Center"
                                    Visibility="{x:Bind IsInstalling, Mode=OneWay}" />

                                <Button
                                    Grid.Column="1"
                                    Width="32"
                                    Height="32"
                                    Padding="0"
                                    ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/ViewErrorInformation')}"
                                    Visibility="{x:Bind IsInstallFailed, Mode=OneWay}">

                                    <Button.Content>
                                        <FontIcon FontSize="14" Glyph="&#xE783;" />
                                    </Button.Content>

                                    <Button.Flyout>
                                        <Flyout
                                            x:Name="ViewErrorInformationFlyout"
                                            Placement="Bottom"
                                            ShouldConstrainToRootBounds="False">

                                            <Flyout.FlyoutPresenterStyle>
                                                <Style BasedOn="{StaticResource DefaultFlyoutPresenterStyle}" TargetType="FlyoutPresenter">
                                                    <Setter Property="Padding" Value="0" />
                                                    <Setter Property="MinWidth" Value="0" />
                                                </Style>
                                            </Flyout.FlyoutPresenterStyle>

                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="40" />
                                                    <RowDefinition Height="*" />
                                                </Grid.RowDefinitions>

                                                <Grid
                                                    Grid.Row="0"
                                                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                    BorderThickness="0,0,0,1">

                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="*" />
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition Width="Auto" />
                                                    </Grid.ColumnDefinitions>

                                                    <FontIcon
                                                        Grid.Column="0"
                                                        Margin="16,0,6,0"
                                                        VerticalAlignment="Center"
                                                        FontSize="16"
                                                        Glyph="&#xE783;" />

                                                    <TextBlock
                                                        Grid.Column="1"
                                                        VerticalAlignment="Center"
                                                        FontSize="14"
                                                        Text="{x:Bind root:ResourceService.GetLocalized('Installer/ErrorInformation')}" />

                                                    <Button
                                                        Grid.Column="2"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        Click="{x:Bind OnCopyErrorInformationClicked}"
                                                        IsEnabled="{x:Bind converter:ValueConverterHelper.IsNotEmptyString(InstallFailedInformation), Mode=OneWay}"
                                                        Style="{StaticResource AlternateCloseButtonStyle}"
                                                        ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/CopyErrorInformation')}">

                                                        <Button.Content>
                                                            <FontIcon
                                                                Margin="4"
                                                                FontSize="16"
                                                                Glyph="&#xE8C8;" />
                                                        </Button.Content>
                                                    </Button>

                                                    <Button
                                                        Grid.Column="3"
                                                        Margin="-5,0,0,0"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        Click="{x:Bind OnCloseFlyoutClicked}"
                                                        Style="{StaticResource AlternateCloseButtonStyle}"
                                                        Tag="ViewErrorInformationFlyout"
                                                        ToolTipService.ToolTip="{x:Bind root:ResourceService.GetLocalized('Installer/CloseFlyout')}">

                                                        <Button.Content>
                                                            <FontIcon
                                                                Margin="4"
                                                                FontSize="16"
                                                                Glyph="&#xE711;" />
                                                        </Button.Content>
                                                    </Button>
                                                </Grid>

                                                <Grid
                                                    Grid.Row="1"
                                                    Width="450"
                                                    MinHeight="100"
                                                    Padding="16,8,16,8">

                                                    <TextBlock Text="{x:Bind InstallFailedInformation, Mode=OneWay}" TextWrapping="Wrap" />
                                                </Grid>
                                            </Grid>
                                        </Flyout>
                                    </Button.Flyout>
                                </Button>
                            </Grid>
                        </Grid>
                    </Grid>

                    <ScrollViewer
                        Grid.Row="1"
                        HorizontalScrollBarVisibility="Disabled"
                        HorizontalScrollMode="Disabled"
                        VerticalScrollBarVisibility="Auto"
                        VerticalScrollMode="Enabled">

                        <StackPanel Margin="0,0,30,30">

                            <!--  基本信息  -->
                            <muxc:Expander
                                Margin="0,0,0,2"
                                Padding="0,6,0,6"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Stretch"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                IsExpanded="True">

                                <muxc:Expander.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <FontIcon
                                            Grid.Column="0"
                                            Margin="0,0,12,0"
                                            FontSize="16"
                                            Glyph="&#xE946;" />

                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind root:ResourceService.GetLocalized('Installer/BasicInformation')}" />
                                    </Grid>
                                </muxc:Expander.Header>

                                <muxc:Expander.Content>
                                    <StackPanel Spacing="3">
                                        <Grid Margin="16,0,10,0" RowSpacing="3">

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                                <RowDefinition Height="Auto" />
                                            </Grid.RowDefinitions>

                                            <FontIcon
                                                Grid.Row="0"
                                                Grid.Column="0"
                                                Margin="0,0,16,0"
                                                FontSize="12"
                                                Glyph="&#xE915;" />

                                            <TextBlock
                                                Grid.Row="0"
                                                Grid.Column="1"
                                                Margin="0,0,3,0"
                                                FontSize="14"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/PackageDescription')}" />

                                            <TextBlock
                                                Grid.Row="0"
                                                Grid.Column="2"
                                                Text="{x:Bind PackageDescription, Mode=OneWay}" />

                                            <FontIcon
                                                Grid.Row="1"
                                                Grid.Column="0"
                                                Margin="0,0,16,0"
                                                FontSize="12"
                                                Glyph="&#xE915;" />

                                            <TextBlock
                                                Grid.Row="1"
                                                Grid.Column="1"
                                                Margin="0,0,3,0"
                                                FontSize="14"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/PackageFamilyName')}" />

                                            <TextBlock
                                                Grid.Row="1"
                                                Grid.Column="2"
                                                Text="{x:Bind PackageFamilyName, Mode=OneWay}" />

                                            <FontIcon
                                                Grid.Row="2"
                                                Grid.Column="0"
                                                Margin="0,0,16,0"
                                                FontSize="12"
                                                Glyph="&#xE915;" />

                                            <TextBlock
                                                Grid.Row="2"
                                                Grid.Column="1"
                                                Margin="0,0,3,0"
                                                FontSize="14"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/PackageFullName')}" />

                                            <TextBlock
                                                Grid.Row="2"
                                                Grid.Column="2"
                                                Text="{x:Bind PackageFullName, Mode=OneWay}" />

                                            <MenuFlyoutSeparator
                                                Grid.Row="3"
                                                Grid.ColumnSpan="3"
                                                Margin="6,0,0,0"
                                                Background="{ThemeResource CardStrokeColorDefaultBrush}" />

                                            <FontIcon
                                                Grid.Row="4"
                                                Grid.Column="0"
                                                Margin="0,0,16,0"
                                                FontSize="12"
                                                Glyph="&#xE915;" />

                                            <TextBlock
                                                Grid.Row="4"
                                                Grid.Column="1"
                                                Margin="0,0,3,0"
                                                FontSize="14"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/SupportedArchitecture')}" />

                                            <TextBlock
                                                Grid.Row="4"
                                                Grid.Column="2"
                                                Text="{x:Bind SupportedArchitecture, Mode=OneWay}" />

                                            <FontIcon
                                                Grid.Row="5"
                                                Grid.Column="0"
                                                Margin="0,0,16,0"
                                                FontSize="12"
                                                Glyph="&#xE915;" />

                                            <TextBlock
                                                Grid.Row="5"
                                                Grid.Column="1"
                                                Margin="0,0,3,0"
                                                FontSize="14"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/IsFramework')}" />

                                            <TextBlock
                                                Grid.Row="5"
                                                Grid.Column="2"
                                                Text="{x:Bind IsFramework, Mode=OneWay}" />
                                        </Grid>
                                    </StackPanel>
                                </muxc:Expander.Content>
                            </muxc:Expander>

                            <!--  目标设备信息  -->
                            <muxc:Expander
                                Margin="0,0,0,2"
                                Padding="0"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Stretch"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                IsExpanded="True"
                                Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityConvert(TargetDeviceFamilyCollection.Count), Mode=OneWay}">

                                <muxc:Expander.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <FontIcon
                                            Grid.Column="0"
                                            Margin="0,0,12,0"
                                            FontSize="16"
                                            Glyph="&#xE7F8;" />

                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind root:ResourceService.GetLocalized('Installer/TargetDeviceFamily')}" />
                                    </Grid>
                                </muxc:Expander.Header>

                                <muxc:Expander.Content>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <Grid
                                            Grid.Row="0"
                                            Height="35"
                                            Padding="16,0,16,0"
                                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                            BorderThickness="0">

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="3*" />
                                                <ColumnDefinition Width="2*" />
                                                <ColumnDefinition Width="2*" />
                                            </Grid.ColumnDefinitions>

                                            <TextBlock
                                                x:Name="TargetDeviceNameHeaderText"
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/TargetDeviceName')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/TargetDeviceName')}"
                                                        Visibility="{x:Bind TargetDeviceNameHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>

                                            <TextBlock
                                                x:Name="MinVersionHeaderText"
                                                Grid.Column="1"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/MinVersion')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/MinVersion')}"
                                                        Visibility="{x:Bind MinVersionHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>

                                            <TextBlock
                                                x:Name="MaxVersionTestedHeaderText"
                                                Grid.Column="2"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/MaxVersionTested')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/MaxVersionTested')}"
                                                        Visibility="{x:Bind MaxVersionTestedHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>
                                        </Grid>

                                        <ListView
                                            Grid.Row="1"
                                            ItemsSource="{x:Bind TargetDeviceFamilyCollection, Mode=OneWay}"
                                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                            ScrollViewer.HorizontalScrollMode="Disabled"
                                            ScrollViewer.VerticalScrollBarVisibility="Auto"
                                            ScrollViewer.VerticalScrollMode="Enabled"
                                            SelectionMode="None">

                                            <ListView.ItemContainerStyle>
                                                <Style BasedOn="{StaticResource DefaultListViewItemStyle}" TargetType="ListViewItem">
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="Margin" Value="0" />
                                                    <Setter Property="MinHeight" Value="0" />
                                                    <Setter Property="Padding" Value="0" />
                                                </Style>
                                            </ListView.ItemContainerStyle>

                                            <ListView.ItemTemplate>
                                                <DataTemplate x:DataType="model:TargetDeviceFamilyModel">
                                                    <Grid
                                                        Height="35"
                                                        Padding="16,0,16,0"
                                                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                        BorderThickness="0,1,0,0">

                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="3*" />
                                                            <ColumnDefinition Width="2*" />
                                                            <ColumnDefinition Width="2*" />
                                                        </Grid.ColumnDefinitions>

                                                        <TextBlock
                                                            x:Name="TargetDeviceNameText"
                                                            Grid.Column="0"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind TargetDeviceName}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind TargetDeviceName}"
                                                                    Visibility="{Binding ElementName=TargetDeviceNameText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>

                                                        <TextBlock
                                                            x:Name="MinVersionText"
                                                            Grid.Column="1"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind MinVersion.ToString()}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind MinVersion.ToString()}"
                                                                    Visibility="{Binding ElementName=MinVersionText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>

                                                        <TextBlock
                                                            x:Name="MaxVersionTestedText"
                                                            Grid.Column="2"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind MaxVersionTested.ToString()}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind MaxVersionTested.ToString()}"
                                                                    Visibility="{Binding ElementName=MaxVersionTestedText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </Grid>
                                </muxc:Expander.Content>
                            </muxc:Expander>

                            <!--  依赖项信息  -->
                            <muxc:Expander
                                Margin="0,0,0,2"
                                Padding="0"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Stretch"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                IsExpanded="True"
                                Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityConvert(DependencyCollection.Count), Mode=OneWay}">

                                <muxc:Expander.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <FontIcon
                                            Grid.Column="0"
                                            Margin="0,0,12,0"
                                            FontSize="16"
                                            Glyph="&#xE8AB;" />

                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind root:ResourceService.GetLocalized('Installer/PackageDependency')}" />
                                    </Grid>
                                </muxc:Expander.Header>

                                <muxc:Expander.Content>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <Grid
                                            Grid.Row="0"
                                            Height="35"
                                            Padding="16,0,16,0"
                                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                            BorderThickness="0">

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="2*" />
                                                <ColumnDefinition Width="2*" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <TextBlock
                                                x:Name="DependencyNameHeaderText"
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/DependencyName')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/DependencyName')}"
                                                        Visibility="{x:Bind DependencyNameHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>

                                            <TextBlock
                                                x:Name="DependencyPublisherHeaderText"
                                                Grid.Column="1"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/DependencyPublisher')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/DependencyPublisher')}"
                                                        Visibility="{x:Bind DependencyPublisherHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>

                                            <TextBlock
                                                x:Name="DependencyMinVersionHeaderText"
                                                Grid.Column="2"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/DependencyMinVersion')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/DependencyMinVersion')}"
                                                        Visibility="{x:Bind DependencyMinVersionHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>

                                            <TextBlock
                                                x:Name="DependencySatisfiedHeaderText"
                                                Grid.Column="3"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/DependencySatisfied')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/DependencySatisfied')}"
                                                        Visibility="{x:Bind DependencySatisfiedHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>
                                        </Grid>

                                        <ListView
                                            Grid.Row="1"
                                            ItemsSource="{x:Bind DependencyCollection, Mode=OneWay}"
                                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                            ScrollViewer.HorizontalScrollMode="Disabled"
                                            ScrollViewer.VerticalScrollBarVisibility="Auto"
                                            ScrollViewer.VerticalScrollMode="Enabled"
                                            SelectionMode="None">

                                            <ListView.ItemContainerStyle>
                                                <Style BasedOn="{StaticResource DefaultListViewItemStyle}" TargetType="ListViewItem">
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="Margin" Value="0" />
                                                    <Setter Property="MinHeight" Value="0" />
                                                    <Setter Property="Padding" Value="0" />
                                                </Style>
                                            </ListView.ItemContainerStyle>

                                            <ListView.ItemTemplate>
                                                <DataTemplate x:DataType="model:DependencyModel">
                                                    <Grid
                                                        Height="35"
                                                        Padding="16,0,16,0"
                                                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                        BorderThickness="0,1,0,0">

                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="2*" />
                                                            <ColumnDefinition Width="2*" />
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>

                                                        <TextBlock
                                                            x:Name="DependencyNameText"
                                                            Grid.Column="0"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind DependencyName}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind DependencyName}"
                                                                    Visibility="{Binding ElementName=DependencyNameText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>

                                                        <TextBlock
                                                            x:Name="DependencyPublisherText"
                                                            Grid.Column="1"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind DependencyPublisher}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind DependencyPublisher}"
                                                                    Visibility="{Binding ElementName=DependencyPublisherText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>

                                                        <TextBlock
                                                            x:Name="DependencyMinVersionText"
                                                            Grid.Column="2"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind DependencyMinVersion.ToString()}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind DependencyMinVersion.ToString()}"
                                                                    Visibility="{Binding ElementName=DependencyMinVersionText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>

                                                        <TextBlock
                                                            x:Name="DependencySatisfiedText"
                                                            Grid.Column="3"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind DependencySatisfied}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind DependencySatisfied}"
                                                                    Visibility="{Binding ElementName=DependencySatisfiedText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </Grid>
                                </muxc:Expander.Content>
                            </muxc:Expander>

                            <!--  应用包功能信息  -->
                            <muxc:Expander
                                Margin="0,0,0,2"
                                Padding="0"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Stretch"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                IsExpanded="True"
                                Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityConvert(CapabilitiesCollection.Count), Mode=OneWay}">

                                <muxc:Expander.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <FontIcon
                                            Grid.Column="0"
                                            Margin="0,0,12,0"
                                            FontSize="16"
                                            Glyph="&#xE8A1;" />

                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind root:ResourceService.GetLocalized('Installer/PackageCapabilities')}" />
                                    </Grid>
                                </muxc:Expander.Header>

                                <muxc:Expander.Content>
                                    <GridView
                                        Margin="16,4,16,-4"
                                        ItemsSource="{x:Bind CapabilitiesCollection, Mode=OneWay}"
                                        SelectionMode="None">

                                        <GridView.ItemContainerStyle>
                                            <Style BasedOn="{StaticResource DefaultGridViewItemStyle}" TargetType="GridViewItem">
                                                <Setter Property="Margin" Value="0" />
                                                <Setter Property="MinHeight" Value="0" />
                                            </Style>
                                        </GridView.ItemContainerStyle>

                                        <GridView.ItemTemplate>
                                            <DataTemplate x:DataType="x:String">
                                                <GridViewItem
                                                    Width="230"
                                                    Height="30"
                                                    HorizontalContentAlignment="Left">
                                                    <Grid HorizontalAlignment="Left">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>

                                                        <FontIcon
                                                            Grid.Column="0"
                                                            Margin="0,0,12,0"
                                                            FontSize="12"
                                                            Glyph="&#xE915;" />

                                                        <TextBlock
                                                            x:Name="CapabilitiesText"
                                                            Grid.Column="1"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind}"
                                                                    Visibility="{Binding ElementName=CapabilitiesText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>
                                                    </Grid>
                                                </GridViewItem>
                                            </DataTemplate>
                                        </GridView.ItemTemplate>
                                    </GridView>
                                </muxc:Expander.Content>
                            </muxc:Expander>

                            <!--  应用包应用信息  -->
                            <muxc:Expander
                                Margin="0,0,0,2"
                                Padding="0"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Stretch"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                IsExpanded="True"
                                Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityConvert(ApplicationCollection.Count), Mode=OneWay}">

                                <muxc:Expander.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <FontIcon
                                            Grid.Column="0"
                                            Margin="0,0,12,0"
                                            FontSize="16"
                                            Glyph="&#xE71D;" />

                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind root:ResourceService.GetLocalized('Installer/PackageApplication')}" />
                                    </Grid>
                                </muxc:Expander.Header>

                                <muxc:Expander.Content>
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto" />
                                            <RowDefinition Height="Auto" />
                                        </Grid.RowDefinitions>

                                        <Grid
                                            Grid.Row="0"
                                            Height="35"
                                            Padding="16,0,16,0"
                                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                            BorderThickness="0">

                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="*" />
                                            </Grid.ColumnDefinitions>

                                            <TextBlock
                                                x:Name="AppIDHeaderText"
                                                Grid.Column="0"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/AppID')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/AppID')}"
                                                        Visibility="{x:Bind AppIDHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>

                                            <TextBlock
                                                x:Name="AppDescriptionHeaderText"
                                                Grid.Column="1"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/AppDescription')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/AppDescription')}"
                                                        Visibility="{x:Bind AppDescriptionHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>

                                            <TextBlock
                                                x:Name="ExecutableHeaderText"
                                                Grid.Column="2"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/Executable')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/Executable')}"
                                                        Visibility="{x:Bind ExecutableHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>

                                            <TextBlock
                                                x:Name="EntryPointHeaderText"
                                                Grid.Column="3"
                                                VerticalAlignment="Center"
                                                Text="{x:Bind root:ResourceService.GetLocalized('Installer/EntryPoint')}"
                                                TextAlignment="Left"
                                                TextTrimming="CharacterEllipsis"
                                                TextWrapping="NoWrap">

                                                <ToolTipService.ToolTip>
                                                    <ToolTip
                                                        MaxWidth="9999"
                                                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/EntryPoint')}"
                                                        Visibility="{x:Bind EntryPointHeaderText.IsTextTrimmed, Mode=OneWay}" />
                                                </ToolTipService.ToolTip>
                                            </TextBlock>
                                        </Grid>

                                        <ListView
                                            Grid.Row="1"
                                            ItemsSource="{x:Bind ApplicationCollection, Mode=OneWay}"
                                            ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                            ScrollViewer.HorizontalScrollMode="Disabled"
                                            ScrollViewer.VerticalScrollBarVisibility="Auto"
                                            ScrollViewer.VerticalScrollMode="Enabled"
                                            SelectionMode="None">

                                            <ListView.ItemContainerStyle>
                                                <Style BasedOn="{StaticResource DefaultListViewItemStyle}" TargetType="ListViewItem">
                                                    <Setter Property="Background" Value="Transparent" />
                                                    <Setter Property="Margin" Value="0" />
                                                    <Setter Property="MinHeight" Value="0" />
                                                    <Setter Property="Padding" Value="0" />
                                                </Style>
                                            </ListView.ItemContainerStyle>

                                            <ListView.ItemTemplate>
                                                <DataTemplate x:DataType="model:ApplicationModel">
                                                    <Grid
                                                        Height="35"
                                                        Padding="16,0,16,0"
                                                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                                        BorderThickness="0,1,0,0">

                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="*" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>

                                                        <TextBlock
                                                            x:Name="AppIDText"
                                                            Grid.Column="0"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind AppID}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind AppID}"
                                                                    Visibility="{Binding ElementName=AppIDText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>

                                                        <TextBlock
                                                            x:Name="AppDescriptionText"
                                                            Grid.Column="1"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind AppDescription}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind AppDescription}"
                                                                    Visibility="{Binding ElementName=AppDescriptionText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>

                                                        <TextBlock
                                                            x:Name="ExecutableText"
                                                            Grid.Column="2"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind Executable}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind Executable}"
                                                                    Visibility="{Binding ElementName=ExecutableText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>

                                                        <TextBlock
                                                            x:Name="EntryPointText"
                                                            Grid.Column="3"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind EntryPoint}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip
                                                                    MaxWidth="9999"
                                                                    Content="{x:Bind EntryPoint}"
                                                                    Visibility="{Binding ElementName=EntryPointText, Path=IsTextTrimmed, Mode=OneWay}" />
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>
                                                    </Grid>
                                                </DataTemplate>
                                            </ListView.ItemTemplate>
                                        </ListView>
                                    </Grid>
                                </muxc:Expander.Content>
                            </muxc:Expander>

                            <!--  应用包语言信息  -->
                            <muxc:Expander
                                Padding="0"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Stretch"
                                Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                                IsExpanded="True"
                                Visibility="{x:Bind converter:ValueConverterHelper.IntToVisibilityConvert(LanguageCollection.Count), Mode=OneWay}">

                                <muxc:Expander.Header>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>

                                        <FontIcon
                                            Grid.Column="0"
                                            Margin="0,0,12,0"
                                            FontSize="16"
                                            Glyph="&#xF2B7;" />

                                        <TextBlock
                                            Grid.Column="1"
                                            VerticalAlignment="Center"
                                            Text="{x:Bind root:ResourceService.GetLocalized('Installer/PackageLanguage')}" />
                                    </Grid>
                                </muxc:Expander.Header>

                                <muxc:Expander.Content>
                                    <GridView
                                        Margin="16,4,16,-4"
                                        ItemsSource="{x:Bind LanguageCollection, Mode=OneWay}"
                                        SelectionMode="None">

                                        <GridView.ItemContainerStyle>
                                            <Style BasedOn="{StaticResource DefaultGridViewItemStyle}" TargetType="GridViewItem">
                                                <Setter Property="Margin" Value="0" />
                                                <Setter Property="MinHeight" Value="0" />
                                            </Style>
                                        </GridView.ItemContainerStyle>

                                        <GridView.ItemTemplate>
                                            <DataTemplate x:DataType="language:Language">
                                                <GridViewItem
                                                    Width="230"
                                                    Height="30"
                                                    HorizontalContentAlignment="Left">
                                                    <Grid HorizontalAlignment="Left">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="*" />
                                                        </Grid.ColumnDefinitions>

                                                        <FontIcon
                                                            Grid.Column="0"
                                                            Margin="0,0,12,0"
                                                            FontSize="12"
                                                            Glyph="&#xE915;" />

                                                        <TextBlock
                                                            Grid.Column="1"
                                                            VerticalAlignment="Center"
                                                            Text="{x:Bind DisplayName}"
                                                            TextAlignment="Left"
                                                            TextTrimming="CharacterEllipsis"
                                                            TextWrapping="NoWrap">

                                                            <ToolTipService.ToolTip>
                                                                <ToolTip MaxWidth="9999">
                                                                    <ToolTip.Content>
                                                                        <TextBlock>
                                                                            <Run Text="{x:Bind DisplayName}" />
                                                                            <Run Text=" - " />
                                                                            <Run Text="{x:Bind LanguageTag}" />
                                                                        </TextBlock>
                                                                    </ToolTip.Content>
                                                                </ToolTip>
                                                            </ToolTipService.ToolTip>
                                                        </TextBlock>
                                                    </Grid>
                                                </GridViewItem>
                                            </DataTemplate>
                                        </GridView.ItemTemplate>
                                    </GridView>
                                </muxc:Expander.Content>
                            </muxc:Expander>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>

                <Grid
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Visibility="{x:Bind converter:ValueConverterHelper.BooleanToVisibilityReverseConvert(IsParseSuccessfully), Mode=OneWay}">

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto " />
                        <RowDefinition Height="Auto " />
                    </Grid.RowDefinitions>

                    <TextBlock
                        Grid.Row="0"
                        FontSize="26"
                        Text="{x:Bind root:ResourceService.GetLocalized('Installer/ParseFailed')}" />

                    <Button
                        Grid.Row="1"
                        HorizontalAlignment="Center"
                        Click="{x:Bind OnOpenOtherPackageClicked}"
                        Content="{x:Bind root:ResourceService.GetLocalized('Installer/OpenOtherPackage')}" />
                </Grid>
            </Grid>
        </Grid>

        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup>
                <VisualState x:Name="BackgroundDefault">
                    <VisualState.Setters>
                        <Setter Target="MainPageRoot.Background" Value="{ThemeResource DefaultBackgroundColorBrush}" />
                    </VisualState.Setters>
                </VisualState>
                <VisualState x:Name="BackgroundTransparent">
                    <VisualState.Setters>
                        <Setter Target="MainPageRoot.Background" Value="Transparent" />
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</Page>
